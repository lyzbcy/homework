# 基于知识图谱的医药问答系统

## 🚀 快速开始

### 📍 第一步：打开命令行窗口

**方法一：从项目文件夹打开（推荐）**
1. 打开文件资源管理器，导航到项目文件夹：
   ```
   E:\学委\作业\大三上\知识工程\第五章：基于知识图谱的医药问答系统实战\QAMedicalKG
   ```
2. 在文件夹空白处，按住 `Shift` 键，然后右键点击
3. 选择 **"在此处打开 PowerShell 窗口"**

**方法二：手动打开**
1. 按 `Win + R`，输入 `cmd` 或 `powershell`，按回车
2. 在命令行中输入：
   ```powershell
   cd "E:\学委\作业\大三上\知识工程\第五章：基于知识图谱的医药问答系统实战\QAMedicalKG"
   ```

### 📦 第二步：安装Python依赖

在命令行窗口中输入（直接复制粘贴）：
```powershell
pip install -r requirements.txt
```

**说明：**
- 如果提示 `pip 不是内部或外部命令`，尝试：`python -m pip install -r requirements.txt`
- 如果提示权限错误，尝试：`pip install --user -r requirements.txt`
- 等待看到 `Successfully installed` 表示安装成功

### 🗄️ 第三步：安装和启动Neo4j数据库

1. **下载Neo4j**
   - 访问：https://neo4j.com/download/
   - 下载并安装Neo4j Desktop（推荐）

2. **启动Neo4j**
   - 打开Neo4j Desktop
   - 创建数据库项目，点击"Start"启动
   - 首次启动设置密码：`tangyudiadid0`

3. **验证Neo4j运行**
   - 打开浏览器访问：http://localhost:7474
   - 如果看到登录界面，说明数据库已启动
   - 使用用户名 `neo4j` 和密码 `tangyudiadid0` 登录

**如果需要修改连接配置，请编辑以下文件：**
- `build_medicalgraph.py` 第10行
- `answer_search.py` 第5行

### 🏗️ 第四步：构建知识图谱（首次运行前必须！）

在命令行窗口中输入：
```powershell
python build_medicalgraph.py
```

**说明：**
- 这个过程可能需要几分钟到十几分钟，请耐心等待
- 确保Neo4j数据库已启动（参考第三步）
- 程序会从 `data/medical2.json` 读取数据并构建Neo4j知识图谱

### 🎯 第四步（增强版）：导入补充资料数据（可选但强烈推荐！）

在命令行窗口中输入：
```powershell
python import_enhanced_data.py
```

**说明：**
- 这会从补充资料中导入禁忌关系、不良反应、注意事项、特殊人群用药等增强数据
- 确保补充资料路径正确（默认在 `../医疗知识图谱/KG_demo代码/data/`）
- 导入后系统将支持更多问题类型，如：
  - "XX药有什么禁忌？"
  - "XX药有什么不良反应？"
  - "XX药儿童能用吗？"
  - "XX症状会导致什么疾病？"
  - 等等

### ✅ 第五步：测试程序（可选但推荐）

在命令行窗口中输入：
```powershell
python test_import.py
```

如果看到所有测试通过，说明环境配置正确。

### 🎯 第六步：运行问答系统

在命令行窗口中输入：
```powershell
python chatbot_graph.py
```

程序启动后，会显示 `咨询:` 提示符，你可以输入问题进行测试：
- `感冒的症状是什么？`
- `感冒用什么药？`
- `如何预防感冒？`

按 `Ctrl + C` 可以退出程序。

---

## 📖 更详细的使用说明

**如果你对操作步骤不熟悉，请查看：**
- 📄 [详细使用指南.md](详细使用指南.md) - 包含每一步的详细操作说明和常见问题解答
- 📄 [配置说明.md](配置说明.md) - 包含程序调试和配置说明

## 项目结构

```
QAMedicalKG/
├── chatbot_graph.py          # 主程序入口
├── question_classifier.py    # 问题分类器
├── question_parser.py        # 问题解析器
├── answer_search.py          # 答案搜索器
├── build_medicalgraph.py     # 知识图谱构建脚本
├── requirements.txt          # 依赖列表
├── test_import.py            # 测试脚本
├── data/                     # 数据目录
│   └── medical2.json         # 医疗知识数据
└── dict/                     # 词典目录
    ├── disease.txt          # 疾病词典
    ├── symptom.txt          # 症状词典
    ├── drug.txt             # 药品词典
    ├── food.txt             # 食物词典
    ├── check.txt            # 检查词典
    ├── department.txt       # 科室词典
    ├── producer.txt         # 厂商词典
    └── deny.txt             # 否定词词典
```

## 使用示例

运行 `chatbot_graph.py` 后，可以输入以下类型的问题：

### 基础问题类型
- 疾病症状：`感冒的症状是什么？`
- 症状疾病：`发烧可能是什么病？`
- 疾病原因：`感冒的原因是什么？`
- 疾病预防：`如何预防感冒？`
- 疾病治疗：`感冒怎么治疗？`
- 疾病药品：`感冒用什么药？`
- 疾病食物：`感冒吃什么食物？`
- 疾病检查：`感冒需要做什么检查？`

### 新增问题类型（需要导入增强数据）
- 药物禁忌：`阿司匹林有什么禁忌？`、`布洛芬不能和什么一起吃？`
- 不良反应：`阿司匹林有什么不良反应？`、`布洛芬有什么副作用？`
- 注意事项：`阿司匹林有什么注意事项？`
- 特殊人群用药：`阿司匹林儿童能用吗？`、`布洛芬孕妇能用吗？`
- 药物成份：`阿司匹林含有什么成份？`
- 症状导致疾病：`发烧会导致什么疾病？`
- 科室查询：`心内科看什么病？`
- 部位查询：`头部容易得什么病？`

## 注意事项

1. 确保Neo4j数据库服务已启动
2. 首次运行前必须先构建知识图谱
3. Windows系统下路径已自动适配，无需手动修改
4. 所有文件使用UTF-8编码

## 常见问题

### 问题1：连接Neo4j失败
- 检查Neo4j服务是否启动
- 检查用户名和密码是否正确
- 检查端口号是否为7474

### 问题2：模块导入失败
- 运行 `pip install -r requirements.txt` 安装依赖
- 确保Python版本 >= 3.6

### 问题3：文件编码错误
- 确保所有文本文件使用UTF-8编码
- 代码已自动处理编码问题

